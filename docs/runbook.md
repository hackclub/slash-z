
# Slash-Z Runbook


## Potential issue we can encounter in slash-z

- Slash-z stops reporting to grafana

## What to do in case of slash-z does not work properly

- Restart the Heroku dyno

# How to certify that slash-z runs as it should

## Things slash-z can do

1. Start a new call via slack using /z command
2. Create a new call by hitting the endpoint [https://js-slash-z.herokuapp.com/api/endpoints/new-schedule-link](https://js-slash-z.herokuapp.com/api/endpoints/new-schedule-link) -- which the Google Calendar integration uses
3. Report the number of open hosts along with the total number of zoom licenses in the db
4. Keep track of the number of participants in a call
5. Invalidate stale calls 

## How to test if slash-z runs properly

## Testing slack calls 

- start a new call from HackClub slack channel using `/z` command
- A new call should be created and will look like this 
![slack-call](./img/slack-call.png)
- Join the call by clicking the Join button
- Keep an eye on the Slack call message to make sure it updates with a gravar
- If the participants card doesn't update, then something is definitely wrong

## Creating a new scheduled call

- Start a new scheduled call by hitting [https://js-slash-z.herokuapp.com/api/endpoints/new-schedule-link](https://js-slash-z.herokuapp.com/api/endpoints/new-schedule-link)
- get and copy the property value of `videoUri`
- open the property value i.e the call link in a new tab -- this should trigger zoom to launch a new call 
* take note of the zoom call id -- this will be useful later for following up with the call's events using the zstory script
> given a call such as **https://hackclub.zoom.us/j/81651504037?pwd=YlE1ekFHckNhSm9GZDJtd2NZNnozQT09#success**, the zoom id is right after the /j path -- in this case **81651504037**
- join the call 
* you may allow an additional person to join your same call to prove that the call link works okay
- then leave the call with your testing partner if any

## Invalidate stale calls

- every minute, slash-z is going to fetch calls older than two minutes relative to it's current time and invalidate those if there are no participants in

## Understanding the events that happened in a call

* For a scheduled call, you will need the call id e.g obuvm
- In your terminal, run `python3 scripts/zstory.py dissect obuvm` -- replace with your own call id

* To understand the events in a particular call, you will required the call id generated by zoom e.g 
- In your terminal, run `python3 scripts/zstory.py dissect 81651504037` -- replace with your own zoom call id



